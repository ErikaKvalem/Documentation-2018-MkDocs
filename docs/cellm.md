

# 3. Documentation on Electrophysiological (atrial) Cell models 
## 3.1 Introduction 

The main goal of this documentation is to introduce the reader into **electrophysiological (atrial) cell models**. 

Cardiac cells models in electrophysiology are **anatomic models** of the heart describing cardiac activity from sub-cellular and cellular level to the level of the whole organ. The models consist on a set of **ordinary differential equations** that describe the cell activity. **[9]**

Applications: Education (i.e cardiology), diagnostic and therapeutic instrumentation. 

These electrophysiologycal models have been developed throughout history since **1952**. The first model was simulated by **Hodgkin-Huxley** on the axon membrane of a giant squid. **[10]**

Other important names have been for example **Noble**, **Beeler-Reuter**, **Luo-Rudy** etc. **[12]**



## 3.2 The Hodgkin–Huxley model
By Alan Lloyd Hodgkin and Andrew Fielding Huxley (1952) 

This model is mentioned here since it basic for the understanding of more complex models. **[13]**

It is a **Conductance-based** model, mathematical model that describes how **action potentials** in **neurons** are initiated and propagated.  

It is a set of **nonlinear differential equations** that approximates the electrical characteristics of excitable cells **(continuous time model)**. 


**Hodgkin and Huxley** found **three** different types of **ion current**; sodium **(Na<sup>+</sup>)**, potassium **(K<sup>+</sup>)**, and a **leak current** that consists mainly of **Cl<sup>-</sup>**. In the cell membrane, there are specific **voltage-gated ion channels** one for each type of ion mentioned before. The components are the following:

- The semipermeable **cell membrane** acts as a **capacitor ($C_m$)**. 

- **$I(t)$**  is the **input current** injected into the cell. 

- Each **channel** type is represented by a **resistor**.The value of the resistance is not fixed, it changes depending on wheter the ion is open or closed.

- Because of **active ion transport** through the cell membrane, the ion concentration inside the cell is different from that in the extracellular liquid. **[The Nernst potential](https://en.wikipedia.org/wiki/Nernst_equation)** generated by the difference in ion concentration is represented by a **battery**. The Nernst potential is different for each ion type therefore there are separate batteries for each ion.

### Circuit representation  **[14]**


![512px-hodgkin-huxley](https://user-images.githubusercontent.com/39902241/41973256-b937848a-7a14-11e8-9c29-164cfe70a4db.png)


**Current** flowing through the **membrane**: $I_m={C_m}\frac{dV_m}{dt}$

**Current** flowing through a given **ion channel**: $I_i=g_n{(V_m-V_i)}$

**Total current**: $I = {C_m}\frac{dV_m}{dt} + {g_(Na)}{(V_m-V_(Na))} + {g_K}{(V_m-V_K)}+ {g_L}{(V_m-V_L)}$

* V in the equations refers to E in the circuit and g is equivalent to R *

**Legend**: 

$R_i$ = Represents the different **ion channels*

$C_m$ = Membrane **capacitance** per unit area

$g_n$ = Ion **conductances** per unit area dependent on time and voltage

$V_i$ = Ion **reversal potentials** (named as E in the image) 

**ODEs**: 

$\frac{D_n}{dt}={\alpha_n}{V_m}{(1-n)}-{\beta_n}{V_m}{n}$

$\frac{D_m}{dt}={\alpha_m}{V_m}{(1-m)}-{\beta_m}{V_m}{m}$

$\frac{D_h}{dt}={\alpha_h}{V_m}{(1-h)}-{\beta_h}{V_m}{h}$



## 3.3 Ventricular Cell models 

The development of models historically has focused more on the **left ventricle**, this is the reason why there are more information available related to this topic rather than to **atria models**. 

For this reason, this section was created since having a background on ventricular models  is helpful to understand atrial cell models. 

The ventricular models that will be mentioned are **The Beeler Reuter model**, **The FitzHugh-Nagumo model** and  **ten Tusscher, Panfilov 2006 model**. 
Other related  models:  **The Luo Rudy dynamic model** and **The Aliev-Panfilov model**. **[12]**

### 3.3.2 The Beeler Reuter model
By: Penny Noble of Oxford University

Reference code: [Flavio Fenton's Java code](http://thevirtualheart.org/)

#### Model description

**The Beeler Reuter model** is a **biophysical based model** describing mammalian ventricular action potential. 

It is a very basic model where the **total ionic flux** is divided into only **four individual ionic currents**. However, it includes a representation of the **intracellular calcium ion concentration**. 

Moreover, it implements a **fast-inward** Na+ current, a second **slower inactivation gate**, a **time-dependent outward current**, a **time-independent K<sup>+</sup> outward current** and a **slow inward current** carried primarily by **Ca<sup>+2</sup>**. For this purpose, **eight variables** are used. **[15]**

The equations for this modeled will not be covered here since they are of a higher level of complexity. However they can be found by running the **JSim model applet** and clicking on the Source tab at the bottom left of JSim's Run Time graphical user interface. The equations are written in **JSim's Mathematical Modeling Language (MML)**. **[16]**

### Schematic representation

![beeler_reuter_1977](https://user-images.githubusercontent.com/39902241/41973581-a772038c-7a15-11e8-80f7-3dc8a3642995.png)

The cell membrane is represented in blue and the ionic channels in yellow. There are only 4 ionic channels and 4 ionic currents. 8 variables in total. This is a very basic model. 

### 3.3.3 The FitzHugh-Nagumo model

By: Penny Noble of Oxford University


#### Model description

This is an **Empirical model** which aims for a **larger spatial and temporal scale** and provides an action potential at a **minimal computational cost**.

Is based on the cubic excitation model but it also includes a **recovery variable** so both *depolarisation and repolarisation* can be modelled. 

ODEs: 

$ \frac{dV}{dt} = f(V) - W + I $

$ \frac{dW}{dt} = {a}{({b}{V}-{c}{W})}$

V = **Voltage** like variable (cubic nonlinearity)

W= **Recovery** variable (linear dynamics)

f(V) = **polynomial** of degree 3

a,b and c = **Constant** parameters


### 3.3.4 The ten Tusscher, Panfilov, 2006 

By: Penny Noble of Oxford University

#### Model description

This model describes **human epicardial, endocardial and midmyocardial cells**. Multiple action potentials can be stimulated at the same time with frequency 1 Hz. 

This model focus on  **Action potential durantion (APD)** restitution and **intracellular Ca<sup>+2</sup> dynamics**. 

This model is used to study **ventricular fibrilation** since dynamical inestabilities in APD are directly related to it. The key concept for inestability is the **recovery dynamics of fast Na+ current**.  Slower Na+ current recovery means **longer periods** of spiral wave rotation and more gradual **conduction velocity restitution**. And these two things lead to **inestability**.

There are two different **versions** of this model. The *A* version is a full description of the Ca<sup>+2</sup> dynamics **(17 variables)** and the *B* option is a simplified version with **9 variables** ( voltage and 8 gates). 

#### Schematic representation

![screen shot 2018-07-02 at 3 07 12 pm](https://user-images.githubusercontent.com/39902241/42165898-b2ad9732-7e09-11e8-94c6-9dfa04f0c6df.png)

*A* version of the model including Ca<sup>+2</sup> dynamic. Taking into account troponin, Calmodulin and Calsequestrin.  

## 3.4 Comparison Ventricular vs Atrial models 

![screen shot 2018-07-05 at 12 39 21 pm](https://user-images.githubusercontent.com/39902241/42318875-9d12c778-8050-11e8-908e-b9950f5f05b2.png)
Caption: 

- Action potential **(AP)** 

- Transient outward current **($I_t$)**

- Ca+2 dependent K+ current **(IK(Ca))**

- Maintained time and voltage dependent delayed rectifier K+ current **(IK)**

- Inward rectifying K+ current **(IK1)**.  It is the outward current generating resting membrane potential and modulating final repolarization in both atria and ventricle. 

- Slowly inactivating sustained outward current **(I(so)) **

- Rapid inactivation outward current **(I(to))**. 

## 3.5 Atrial cell models

### 3.5.1 Nygren 1998 cell model
By: A. Nygren, C. Fiset, L. Firek, J.W. Clark, D.S. Lindblad, R.B. Clark and W.R. Giles

#### Model description

This is a **mathematical model** of an **adult human atrial cell**. 

It uses an **electrical circuit** for the sarcolemma coupled to a **fluid compartment model**. This second part of the model accounts for the changesin ionic concentrations in the cytoplasm and sacoplasmic reticulum. 

This models focus mainly in the important role of the **sustained outward K<sup>+</sup> current **(I)** that is directly related with the **duration of the AP** in human atrial cells. 

Moreover it shows that the AP shape at the **peak** and **plateau** phases are mainly conditioned by **transient outward K<sup>+</sup> current I<sub>sus</sub>, and **L-type Ca<sup>+2</sup> current I<sub>CaL</sub>. 

As a result it suggest that the functional role of I<sub>sus</sub> depends on the physiological state of the cell. 

This model uses the following membrane currents: 

-  I<sub>Na</sub> Na+ current

- I<sub>CaL</sub> L-type Ca+2 current

- I<sub>t</sub>. Transient outward current

- I<sub>sus</sub> Sustained outward K+ current 

- I<sub>K,r</sub> Delayed  rapid rectifier K+ current 

- I<sub>K,s</sub> Delayed  slow rectifier K+ current 

Time independent currents: 

- I<sub>K1</sub> Inward rectifying K+ current

- I<sub>CaP</sub> Ca+2 pump current

- I<sub>NaK</sub>  Na+-K+ pump current

- I<sub>NaCa</sub> Na+-Ca+2 exchanger current 

- I<sub>B,Na</sub> Na+ background (leakage) current

- I<sub>B,Ca</sub>Ca+2 background (leakage) current

####  Schematic representation

![nygren_1998](https://user-images.githubusercontent.com/39902241/42502081-6e17d056-8435-11e8-9d1a-06d0af20d1a8.png)

Electrical circuit on the right (sarcolema)  coupled to fluid compartment model (left). It is represented how Ca<sup>+2</sup> dynamics are in the SR and cytoplasm.

### 3.5.2 Courtemanche 1998 cell model 

By: Penny Noble of Oxford University

#### Model description

This is a  **mathematical** model of the **human atrial AP** based on **Luo Rudy** guinea pig ventricular cells model.

Its main goal is to explain the underlying ionic mechanisms controlling human atrial AP. 

The model explains how strong reductions in I<sub>CaL</sub> (due to disease or intentionally blocked by drugs) can lead to the loss of **rate adaptation of the AP** and contribute to the susceptibility to **Atrial fibrilation (AF)**.

Furthermore, this model shows the importante of **Transient outward K1 current** (I<sub>to</sub>). This current is a key current in the plateaus phase of the AP. Variations in  I<sub>to</sub> cause **AP variability** and therefore can induce to **AF**. 

This model has 21 variables:

- Voltage 

- 12 gating varibables for transmembrane currents

- 3 gating variables for Ca<sup>+2</sup> release current from SR 

- Intracellular Na<sup>+</sup> 

- Intracellular K<sup>+</sup>

Total ionic current:

I<sub>ion</sub> = I<sub>Na</sub> + I<sub>K1</sub> + I<sub>to</sub> + I<sub>Kur</sub> + I<sub>Kr</sub> + I<sub>Ks</sub> + I<sub>Ca,L</sub>+ I<sub>P,Ca</sub> + I<sub>NaK</sub> + I<sub>NaCA</sub>+ I<sub>b,Na</sub> + I<sub>b,Ca</sub>


####  Schematic representation

![courtmanchess](https://user-images.githubusercontent.com/39902241/42322043-3a89ae40-805b-11e8-9c14-a4b082b1c2b3.png)

Representation of the cell membrane with all the ionic channels (yellow) that the model takes into account (12) and intracellular Na<sup>+</sup> and K<sup>+</sup> ( 2 blue channels). Inside it is represented the Sarcoplasmic reticulum ( 3 ionic channels).

### 3.5.3 Maleckar 2009 cell model 

By:  Mary M. Maleckara, Joseph L. Greensteina, Natalia A. Trayanova and Wayne R. Giles

#### Model description

This model is a mathematical model based on the **Nygren model**. Its purpose is to understand **cell to cell interactions** within paracrine environement of **human atrial myocardyum**. 

The model was developed after a exhaustive analysis of the heterogeneous cell to cell interactions on **atrial myocytes** and its effects on **AP**. For this porpuse two extra currents are introduced in this model:

- **Acetylchiline activated K<sup>+</sup> current**

- **Non selective cation current**

This model shows how **non linear interactions** between **ionics currents** in the human atrial myocyte have direct effects on **actylcholine** and cause alterations in the  **AP waveform**.

####  Schematic representation

![maleckar_2009](https://user-images.githubusercontent.com/39902241/42506273-b24118bc-8441-11e8-8f23-560db8fe7352.png)

Same representation as in Nygren model. Including now acetylchiline activated K<sup>+</sup> current and non selective cation current. 












