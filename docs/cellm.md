

# 2. Documentation on Electrophysiological (atrial) Cell models 
## 2.1 Introduction 

The main goal of this documentation is to introduce the reader into **electrophysiological (atrial) cell models**. 

Cardiac cells models in electrophysiology are *anatomic models* of the heart describing cardiac activity from sub-cellular and cellular level to the level of the whole organ. The models consist on a set of *ordinary differential equations* that describe the cell activity.
These are used in a wide range of applications from education and teaching, as for instance in cardiology, to development of diagnostic and therapeutic instrumentation, among other applications. 

These electrophysiologycal models have been developed throughout history since 1952. The first model was simulated by **Hodgkin-Huxley** on the axon membrane of a giant squid. Other important names have been for example **Noble**, **Beeler-Reuter**, **Luo-Rudy** etc.

## 2.2 The Hodgkin–Huxley model
By Alan Lloyd Hodgkin and Andrew Fielding Huxley (1952) 

Conductance-based model, is a mathematical model that describes how action potentials in neurons are initiated and propagated. It is a set of nonlinear differential equations that approximates the electrical characteristics of excitable cells and hence it is a continuous time model. This model is mentioned here so it basic for the understanding of more complex models. 

Hodgkin and Huxley found as a conclusion from the experiments performed on the giant axon of the squid three different types of ion current; sodium(Na+), potassium (K+), and a leak current that consists mainly of Chlorine ions. In the cell membrane, there are specific voltage-gated ion channels one for each type of ion mentioned before. The leak current includes other channel types. 

The semipermeable cell membrane separates the interior of the cell from the extracellular liquid and acts as a capacitor.  I(t)  is the input current injected into the cell. Each channel type is represented by a resistor. The diagonal arrow across the diagram of the resistor indicates that the value of the resistance is not fixed, but changes depending on whether the ion channel is open or closed. Because of active ion transport through the cell membrane, the ion concentration inside the cell is different from that in the extracellular liquid. [The Nernst potential](https://en.wikipedia.org/wiki/Nernst_equation) generated by the difference in ion concentration is represented by a battery. The Nernst potential is different for each ion type therefore there are separate batteries for each ion. 

Current flowing through the membrane: $I_m={C_m}\frac{dV_m}{dt}$

Current flowing through a given ion channel: $I_i=g_n{(V_m-V_i)}$

Total current: $I = {C_m}\frac{dV_m}{dt} + {g_(Na)}{(V_m-V_(Na))} + {g_K}{(V_m-V_K)}+ {g_L}{(V_m-V_L)}$

Legend: 

$C_m$ = Membrane capacitance per unit area

$g_n$ = Ion conductances per unit area dependent on time and voltage

$V_i$ = Ion reversal potentials

ODEs: 

$\frac{D_n}{dt}={\alpha_n}{V_m}{(1-n)}-{\beta_n}{V_m}{n}$

$\frac{D_m}{dt}={\alpha_m}{V_m}{(1-m)}-{\beta_m}{V_m}{m}$

$\frac{D_h}{dt}={\alpha_h}{V_m}{(1-h)}-{\beta_h}{V_m}{h}$



## 2.3 Ventricular Cell models 

The development of models historically has focused more on the **left ventricle**, this is the reason why there are more information available related to this topic rather than to **atria models**. There are physiological differences at the cellular level, electrical conduction differences at the tissue level, but the way atria and ventricles function is essentially the same.
For example, a cell model for atrium and ventricle may differ in some channels resulting current, but the underlying electrophysiology and mechanical behavior is essentially the same. 
For this reason, this section was created since having a background on ventricular models  is helpful to understand atrial cell models. 

The ventricular models that will be mentioned are **The Beeler Reuter model** and **The FitzHugh-Nagumo model**. For more information on other models it is recommended to read about **The Luo Rudy dynamic model** and **The Aliev-Panfilov model**.

### 2.3.2 The Beeler Reuter model
By: Penny Noble

Reference code: [Flavio Fenton's Java code](http://thevirtualheart.org/)

The model is known to run and integrate in the **PCEnv** and **COR CellML** environments. 

*PCEnv is built on the CellML API, and provides a rich graphical user interface for creating CellML models, as well as running the simulations of existing models.*

#### Model description

**The Beeler Reuter model** is a **biophysical based model** describing mammalian ventricular action potential. It is a very basic model where the **total ionic flux** is divided into only **four individual ionic currents**. However, it includes a representation of the **intracellular calcium ion concentration**. Moreover, it implements a *fast-inward* Na+ current, a second *slower inactivation gate*, a *time-dependent outward current*, a *time-independent K+ outward current* and a *slow inward current* carried primarily by **Ca+2**. For this purpose, **eight variables** are used. 

The equations for this modeled will not be covered here since they are of a higher level of complexity. However they can be found by running the **JSim model applet** and clicking on the Source tab at the bottom left of JSim's Run Time graphical user interface. The equations are written in **JSim's Mathematical Modeling Language (MML)**. 


### 2.3.3 The FitzHugh-Nagumo model

By: Penny Noble

The model is known to run and integrate in **COR** and is also known to read in to [**JSim**](http://www.physiome.org/jsim/) and [**PCEnv**](https://www.cellml.org/about/news/pcenv-0-6-and-cellml-api-1-6-released) . 

#### Model description

This is an **Empirical model** which aims for a **larger spatial and temporal scale** and provides an action potential at a **minimal computational cost**.

Is based on the cubic excitation model but it also includes a **recovery variable** so both *depolarisation and repolarisation* can be modelled. 

ODEs: 

$ \frac{dV}{dt} = f(V) - W + I $

$ \frac{dW}{dt} = {a}{({b}{V}-{c}{W})}$

V = Voltage like variable (cubic nonlinearity)
W= recovery variable (linear dynamics)
f(V) = polynomial of degree 3
a,b and c = Constant parameters












