

# 2. Documentation on Electrophysiological (atrial) Cell models 
## 2.1 Introduction 

The main goal of this documentation is to introduce the reader into **electrophysiological (atrial) cell models**. 

Cardiac cells models in electrophysiology are **anatomic models** of the heart describing cardiac activity from sub-cellular and cellular level to the level of the whole organ. The models consist on a set of **ordinary differential equations** that describe the cell activity.

Applications: Education (i.e cardiology), diagnostic and therapeutic instrumentation. 

These electrophysiologycal models have been developed throughout history since **1952**. The first model was simulated by **Hodgkin-Huxley** on the axon membrane of a giant squid. 

Other important names have been for example **Noble**, **Beeler-Reuter**, **Luo-Rudy** etc.



## 2.2 The Hodgkin–Huxley model
By Alan Lloyd Hodgkin and Andrew Fielding Huxley (1952) 

This model is mentioned here since it basic for the understanding of more complex models. 

It is a **Conductance-based** model, mathematical model that describes how **action potentials** in **neurons** are initiated and propagated.

It is a set of **nonlinear differential equations** that approximates the electrical characteristics of excitable cells **(continuous time model)**. 

**Hodgkin and Huxley** found **three** different types of **ion current**; sodium **(Na+)**, potassium **(K+)**, and a **leak current** that consists mainly of **Cl-**. In the cell membrane, there are specific **voltage-gated ion channels** one for each type of ion mentioned before. The components are the following:

- The semipermeable **cell membrane** acts as a **capacitor ($C_m$)**. 

- **$I(t)$**  is the **input current** injected into the cell. 

- Each **channel** type is represented by a **resistor**.The value of the resistance is not fixed, it changes depending on wheter the ion is open or closed.

- Because of **active ion transport** through the cell membrane, the ion concentration inside the cell is different from that in the extracellular liquid. **[The Nernst potential](https://en.wikipedia.org/wiki/Nernst_equation)** generated by the difference in ion concentration is represented by a **battery**. The Nernst potential is different for each ion type therefore there are separate batteries for each ion. 

### Circuit representation


![512px-hodgkin-huxley](https://user-images.githubusercontent.com/39902241/41973256-b937848a-7a14-11e8-9c29-164cfe70a4db.png)


**Current** flowing through the **membrane**: $I_m={C_m}\frac{dV_m}{dt}$

**Current** flowing through a given **ion channel**: $I_i=g_n{(V_m-V_i)}$

**Total current**: $I = {C_m}\frac{dV_m}{dt} + {g_(Na)}{(V_m-V_(Na))} + {g_K}{(V_m-V_K)}+ {g_L}{(V_m-V_L)}$

**Legend**: 

$R_i$ = Represents the different **ion channels*

$C_m$ = Membrane **capacitance** per unit area

$g_n$ = Ion **conductances** per unit area dependent on time and voltage

$V_i$ = Ion **reversal potentials** (named as E in the image) 

**ODEs**: 

$\frac{D_n}{dt}={\alpha_n}{V_m}{(1-n)}-{\beta_n}{V_m}{n}$

$\frac{D_m}{dt}={\alpha_m}{V_m}{(1-m)}-{\beta_m}{V_m}{m}$

$\frac{D_h}{dt}={\alpha_h}{V_m}{(1-h)}-{\beta_h}{V_m}{h}$



## 2.3 Ventricular Cell models 

The development of models historically has focused more on the **left ventricle**, this is the reason why there are more information available related to this topic rather than to **atria models**. 

For this reason, this section was created since having a background on ventricular models  is helpful to understand atrial cell models. 

The ventricular models that will be mentioned are **The Beeler Reuter model**, **The FitzHugh-Nagumo model** and  **ten Tusscher, Panfilov 2006 model**. 
Other related  models:  **The Luo Rudy dynamic model** and **The Aliev-Panfilov model**.

### 2.3.2 The Beeler Reuter model
By: Penny Noble

Reference code: [Flavio Fenton's Java code](http://thevirtualheart.org/)

#### Model description

**The Beeler Reuter model** is a **biophysical based model** describing mammalian ventricular action potential. 

It is a very basic model where the **total ionic flux** is divided into only **four individual ionic currents**. However, it includes a representation of the **intracellular calcium ion concentration**. 

Moreover, it implements a **fast-inward** Na+ current, a second **slower inactivation gate**, a **time-dependent outward current**, a **time-independent K+ outward current** and a **slow inward current** carried primarily by **Ca+2**. For this purpose, **eight variables** are used. 

The equations for this modeled will not be covered here since they are of a higher level of complexity. However they can be found by running the **JSim model applet** and clicking on the Source tab at the bottom left of JSim's Run Time graphical user interface. The equations are written in **JSim's Mathematical Modeling Language (MML)**. 

### Schematic representation

![beeler_reuter_1977](https://user-images.githubusercontent.com/39902241/41973581-a772038c-7a15-11e8-80f7-3dc8a3642995.png)

### 2.3.3 The FitzHugh-Nagumo model

By: Penny Noble 

#### Model description

This is an **Empirical model** which aims for a **larger spatial and temporal scale** and provides an action potential at a **minimal computational cost**.

Is based on the cubic excitation model but it also includes a **recovery variable** so both *depolarisation and repolarisation* can be modelled. 

ODEs: 

$ \frac{dV}{dt} = f(V) - W + I $

$ \frac{dW}{dt} = {a}{({b}{V}-{c}{W})}$

V = **Voltage** like variable (cubic nonlinearity)

W= **Recovery** variable (linear dynamics)

f(V) = **polynomial** of degree 3

a,b and c = **Constant** parameters


### 2.3.4 The ten Tusscher, Panfilov, 2006 

By: Penny Noble of Oxford University

#### Model description

This model describes **human epicardial, endocardial and midmyocardial cells**. Multiple action potentials can be stimulated at the same time with frequency 1 Hz. 

This model focus on  **Action potential durantion (APD)** restitution and **intracellular Ca+2 dynamics**. 

This model is used to study **ventricular fibrilation** since dynamical inestabilities in APD are directly related to it.The key concept for inestability is the **recovery dynamics of fast Na+ current**.  Slower Na+ current recovery means **longer periods** of spiral wave rotation and more gradual **conduction velocity restitution**. And these two things lead to **inestability**.

There are two different **versions** of this model. The a version is a full description of the Ca+2 dynamics **(17 variables)** and the b option is a simplified version with **9 variables** ( voltage and 8 gates). 

### Schematic representation

![screen shot 2018-07-02 at 3 07 12 pm](https://user-images.githubusercontent.com/39902241/42165898-b2ad9732-7e09-11e8-94c6-9dfa04f0c6df.png)

## 2.4 Atrial cell models 







